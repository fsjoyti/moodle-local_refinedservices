define(["jquery"],function(a){var b={init:function(){a(document).ready(function(){function b(b){var c=b/100*a("#progress-wrap-users").width(),d=2500;a("#progress-bar-users").stop().animate({left:c},d)}function c(b){var c=b/100*a("#progress-wrap-courses").width(),d=2500;a("#progress-bar-courses").stop().animate({left:c},d)}function d(b){var c=b/100*a("#progress-wrap-activities").width(),d=2500;a("#progress-bar-activities").stop().animate({left:c},d)}function e(){a.ajax({type:"GET",url:"../local/refinedservices/ajax/connect_update_status.php",success:function(g){g.user&&a("#update_users_message").html(g.user),g.userpercentage&&b(g.userpercentage),g.group&&a("#update_courses_message").html(g.group),g.grouppercentage&&c(g.grouppercentage),g.activity&&a("#update_activities_message").html(g.activity),g.activitypercentage&&d(g.activitypercentage),g.nocheck?f&&(clearInterval(f),f=0):f||(f=setInterval(e,15e3))}})}var f=0;if(a("#connect_service_account_comment").length){a("#connect_service_account_comment").addClass("rt-loading-image"),a("#id_s__refinedservices_host").prop("disabled",!0),a("#id_s__connect_service_username").prop("disabled",!0),a("#id_s__connect_service_password").prop("disabled",!0),a(".form-buttons").hide();var g={};g.plugintype=a("#connect_service_account_comment").attr("data-plugintype"),a.ajax({type:"GET",url:"../local/refinedservices/ajax/get_account.php",data:g,success:function(b){console.log(b),a("#connect_service_account_comment").removeClass("rt-loading-image"),a("#connect_service_account_comment").html(b.message);var c=new Date,d=new Date(b.expired);c>d&&(a("#connect_service_account_comment").removeClass("label-success"),a("#connect_service_account_comment").addClass("label-important")),""==b.username?(b.credentialsinuse||b.domaininuse?(a("#connect_service_credentials_button").show(),a("#connect_service_account_button").hide(),a("#id_s__connect_service_username").removeProp("disabled"),a("#id_s__connect_service_password").removeProp("disabled")):(a("#connect_service_credentials_button").hide(),a("#connect_service_account_button").show()),a("#connect_service_update_users").hide(),a("#connect_service_update_courses").hide(),a("#connect_service_update_activities").hide()):(a("#connect_service_account_button").hide(),a("#connect_service_credentials_button").hide())}})}if(a("#reports_service_account_comment").length){a("#reports_service_account_comment").addClass("rt-loading-image"),a("#id_s__report_service_username").prop("disabled",!0),a("#id_s__report_service_password").prop("disabled",!0),a("#form-buttons").hide();var g={};g.plugintype=a("#reports_service_account_comment").attr("data-plugintype"),a.ajax({type:"GET",url:"../local/refinedservices/ajax/get_account.php",data:g,success:function(b){a("#reports_service_account_comment").removeClass("rt-loading-image"),a("#reports_service_account_comment").html(b.message),""==b.username?a("#reports_service_account_button").show():a("#reports_service_account_button").hide()}})}a("#connect_service_account_button").click(function(b){b.preventDefault();var c={};c.plugintype=a("#connect_service_account_button").attr("data-plugintype"),a("#connect_service_account_comment").addClass("rt-loading-image"),a.ajax({type:"GET",url:"../local/refinedservices/ajax/create_account.php",data:c,success:function(b){a("#connect_service_account_comment").removeClass("rt-loading-image"),a("#connect_service_account_comment").html(b.message),a("#id_s__connect_service_username").attr("value",b.username),a("#id_s__connect_service_password").attr("value",b.password),""!=b.username&&a("#connect_service_account_button").hide()}}),a.ajax({type:"GET",url:"../local/refinedservices/ajax/update_all_connect_settings.php",success:function(a){}})}),a("#connect_service_credentials_button").click(function(b){b.preventDefault();var c={};c.plugintype=a("#connect_service_credentials_button").attr("data-plugintype"),c.username=a("#id_s__connect_service_username").val(),c.password=a("#id_s__connect_service_password").val(),a("#connect_service_account_comment").addClass("rt-loading-image"),a.ajax({type:"GET",url:"../local/refinedservices/ajax/check_credentials.php",data:c,success:function(b){a("#connect_service_account_comment").removeClass("rt-loading-image"),a("#connect_service_account_comment").html(b.message),b.username?(a("#connect_service_credentials_button").hide(),a("#id_s__connect_service_username").prop("disabled",!0),a("#id_s__connect_service_password").prop("disabled",!0),a("#id_s__connect_service_username").val(b.username),a("#id_s__connect_service_password").val(b.password)):(a("#connect_service_credentials_button").show(),a("#id_s__connect_service_username").val(""),a("#id_s__connect_service_password").val(""))}})}),a("#reports_service_account_button").click(function(b){b.preventDefault();var c={};c.plugintype=a("#reports_service_account_button").attr("data-plugintype"),a("#reports_service_account_comment").addClass("rt-loading-image"),a.ajax({type:"GET",url:"../local/refinedservices/ajax/create_account.php",data:c,success:function(b){a("#reports_service_account_comment").removeClass("rt-loading-image"),a("#reports_service_account_comment").html(b.message),a("#id_s__report_service_username").attr("value",b.username),a("#id_s__report_service_password").attr("value",b.password),""!=b.username&&a("#reports_service_account_button").hide()}})}),a("#connect_service_update_users").click(function(b){b.preventDefault();var c={};a("#connect_service_update_comment").addClass("rt-loading-image"),a.ajax({type:"GET",url:"../local/refinedservices/ajax/connect_update.php?action=users",data:c,success:function(b){a("#connect_service_update_comment").removeClass("rt-loading-image"),a("#connect_service_update_comment").html(b.message),setTimeout(e,2e3)}})}),a("#connect_service_update_courses").click(function(b){b.preventDefault();var c={};a("#connect_service_update_comment").addClass("rt-loading-image"),a.ajax({type:"GET",url:"../local/refinedservices/ajax/connect_update.php?action=coursegroups",data:c,success:function(b){a("#connect_service_update_comment").removeClass("rt-loading-image"),a("#connect_service_update_comment").html(b.message),setTimeout(e,2e3)}})}),a("#connect_service_update_activities").click(function(b){b.preventDefault();var c={};a("#connect_service_update_comment").addClass("rt-loading-image"),a.ajax({type:"GET",url:"../local/refinedservices/ajax/connect_update.php?action=activities",data:c,success:function(b){a("#connect_service_update_comment").removeClass("rt-loading-image"),a("#connect_service_update_comment").html(b.message),setTimeout(e,2e3)}})}),a("#connect_service_credentials").click(function(b){b.preventDefault();var c={};c.protocol=a("#id_s__connect_protocol").val(),c.server=a("#id_s__connect_server").val(),c.account=a("#id_s__connect_account").val(),c.admin_login=a("#id_s__connect_admin_login").val(),c.admin_password=a("#id_s__connect_admin_password").val(),c.prefix=a("#id_s__connect_prefix").val(),c.connect_emailaslogin=a("#id_s__connect_emailaslogin").is(":checked")?1:0,c.connect_unameaslogin=a("#id_s__connect_unameaslogin").is(":checked")?1:0,a("#connect_service_credentials_comment").addClass("rt-loading-image"),a.ajax({type:"GET",url:"../local/refinedservices/ajax/update_connect_server_info.php",data:c,success:function(b){a("#connect_service_credentials_comment").removeClass("rt-loading-image"),a("#connect_service_credentials_comment").html(b.message),1==b.auth?(a("#connect_service_credentials_comment").removeClass("label-important"),a("#connect_service_credentials_comment").removeClass("label-danger"),a("#connect_service_credentials_comment").addClass("label-success"),a("#connect_service_update_users").show(),a("#connect_service_update_courses").show(),a("#connect_service_update_activities").show(),e()):(a("#connect_service_credentials_comment").removeClass("label-success"),a("#connect_service_credentials_comment").addClass("label-important"),a("#connect_service_credentials_comment").addClass("label-danger"),a("#connect_service_update_users").hide(),a("#connect_service_update_courses").hide(),a("#connect_service_update_activities").hide())}}),a.ajax({type:"GET",url:"../local/refinedservices/ajax/update_all_connect_settings.php",success:function(a){}})}),a("#connect_service_credentials_comment").length&&(a("#connect_service_update_users").hide(),a("#connect_service_update_courses").hide(),a("#connect_service_update_activities").hide(),a("#connect_service_credentials_comment").html(""),a("#connect_service_credentials_comment").addClass("rt-loading-image"),a.ajax({type:"GET",url:"../local/refinedservices/ajax/check_connect_server_info.php",data:g,success:function(b){a("#connect_service_credentials_comment").removeClass("rt-loading-image"),a("#connect_service_credentials_comment").html(b.message),1==b.auth?(a("#connect_service_credentials_comment").removeClass("label-important"),a("#connect_service_credentials_comment").removeClass("label-danger"),a("#connect_service_credentials_comment").addClass("label-success"),a("#connect_service_update_users").show(),a("#connect_service_update_courses").show(),a("#connect_service_update_activities").show(),e()):(a("#connect_service_credentials_comment").removeClass("label-success"),a("#connect_service_credentials_comment").addClass("label-important"),a("#connect_service_credentials_comment").addClass("label-danger"))}}))})}};return b});